# List recipes (just --list)
default:
    @just --list

# Clean up artifacts
cleanup:
    docker-compose -f ./compose-step-ca.yml down
    rm -f config/*
    rm -f certs/*
    rm -f db/*
    rm -f secrets/*

# Launch a container for tutorial-01
container container="step-ca":
    docker-compose -f $(pwd)/compose-{{container}}.yml up

# Launch a shell in the container
shell container="step-ca":
    docker exec -it tu01-{{container}} sh -c "bash || sh"

# Initialize the Step CA with JWK provisioner
init-ca:
    ./scripts/init-ca.sh

# Launch the Step CA server (run in foreground)
launch-ca:
    ./scripts/launch-ca.sh

# Issue a server certificate using the admin provisioner
issue-cert domain="localhost":
    ./scripts/issue-cert.sh {{domain}}
